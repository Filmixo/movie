<!DOCTYPE html>  
<html lang="en-US">  
<head>  
    <meta charset="UTF-8">  
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">  
    <title>Watching Movie | FILMIXO Professional</title>  
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <style>
        /* ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡ßã‡¶∏‡ßç‡¶ü ‡¶´‡¶æ‡¶á‡¶≤‡ßá‡¶∞ ‡¶∏‡¶Æ‡¶∏‡ßç‡¶§ CSS ‡¶π‡ßÅ‡¶¨‡¶π‡ßÅ ‡¶•‡¶æ‡¶ï‡¶¨‡ßá (‡¶∏‡¶Ç‡¶ï‡ßç‡¶∑‡¶ø‡¶™‡ßç‡¶§ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ü‡¶Æ‡¶ø ‡¶∂‡ßÅ‡¶ß‡ßÅ ‡¶ú‡¶∞‡ßÅ‡¶∞‡¶ø ‡¶Ö‡¶Ç‡¶∂ ‡¶∞‡¶æ‡¶ñ‡¶õ‡¶ø) */
        /* ‡¶Ü‡¶™‡¶®‡¶ø ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ post.html ‡¶è‡¶∞ <style> ‡¶ü‡ßç‡¶Ø‡¶æ‡¶ó ‡¶•‡ßá‡¶ï‡ßá ‡¶∏‡¶¨ ‡¶ï‡ßã‡¶° ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶™‡ßá‡¶∏‡ßç‡¶ü ‡¶ï‡¶∞‡¶¨‡ßá‡¶® */
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: Arial, Helvetica, sans-serif; text-decoration: none; }  
        body { background: #fff; display: flex; justify-content: center; -webkit-tap-highlight-color: transparent; }
        .main-wrapper { width: 100%; max-width: 600px; min-height: 100vh; background: #fff; position: relative; border-left: 1px solid #eee; border-right: 1px solid #eee; }
        header { background: #0b78d0; padding: 10px 15px; display: flex; justify-content: space-between; align-items: center; color: white; position: sticky; top: 0; z-index: 100; }
        .logo-area { font-weight: 900; font-size: 23px; text-transform: uppercase; display: flex; align-items: center; }
        .header-btn { background: white; color: #1da1f2; padding: 6px 15px; border-radius: 15px; font-weight: bold; font-size: 12px; cursor: pointer; display: inline-flex; align-items: center; }
        .ad-box { width: 100%; min-height: 50px; margin: 5px 0; background: #fafafa; display: block; overflow: hidden; }
        .watch-container { width: 100%; aspect-ratio: 16/9; background: #000; position: relative; }
        .watch-container iframe { width: 100%; height: 100%; border: none; }
        /* ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶∏‡ßá‡¶ï‡¶∂‡¶® ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ */
        .download-title-text { font-size: 20px; font-weight: 800; color: #0f1419; text-align: center; margin: 25px 0; border-top: 1px solid #e1e8ed; padding-top: 15px; }
        .download-buttons-container { padding: 0 15px; margin-bottom: 20px; display: flex; gap: 10px; }
        .download-btn-v2 { flex: 1; padding: 12px 5px; border-radius: 6px; text-align: center; color: white; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px; font-size: 11px; font-weight: 900; }
        .site-footer { padding: 20px 10px; text-align: center; border-top: 1px solid #eee; }
        .footer-links { display: flex; justify-content: center; gap: 12px; margin-bottom: 15px; }
        .footer-links a { color: #444444; font-size: 12.5px; font-weight: 600; }
    </style>
</head>
<body>

<div class="main-wrapper">
    <header>  
        <div class="logo-area"><i class="fa-solid fa-clapperboard" style="margin-right: 8px;"></i>FILMIXO</div>
        <div>  
            <span class="header-btn" onclick="window.location.href='index.html'"><i class="fa-solid fa-house" style="margin-right: 5px;"></i>Home</span>
        </div>  
    </header>

    <div id="ad-box-top" class="ad-box"></div>

    <div class="watch-container" id="video-player">
        </div>

    <div id="ad-box-video" class="ad-box"></div>

    <div id="dynamic-download-section">
        </div>

    <footer class="site-footer">  
        <div class="footer-links"> <a href="about.html">About Us</a> <a href="contact.html">Contact Us</a> <a href="privacy.html">Privacy Policy</a> <a href="terms.html">Terms & Conditions</a> </div>  
        <div class="footer-copyright">Copyright ¬© 2026 <a href="index.html">filmixo.com</a>. All rights reserved.</div>  
    </footer>
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-app.js";  
    import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore.js";  
  
    const firebaseConfig = { apiKey: "AIzaSyCAsD8wucLsudzY5oNbiixLGyjN2apdV0Q", authDomain: "my-ad-analytics-4560a.firebaseapp.com", projectId: "my-ad-analytics-4560a", storageBucket: "my-ad-analytics-4560a.firebasestorage.app", messagingSenderId: "104213283950", appId: "1:104213283950:web:b5a25ecd54df809625127f" };  
    const app = initializeApp(firebaseConfig);  
    const db = getFirestore(app);

    const urlParams = new URLSearchParams(window.location.search);
    const postId = urlParams.get('id');

    async function loadWatchPage() {
        if (!postId) return window.location.href = 'index.html';
        
        const docRef = doc(db, "posts", postId);
        const docSnap = await getDoc(docRef);

        if (docSnap.exists()) {
            const post = docSnap.data();
            
            // ‡ßß. ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶è‡¶Æ‡¶¨‡ßá‡¶° ‡¶≤‡ßã‡¶°
            if(post.youtubeEmbed) {
                document.getElementById('video-player').innerHTML = post.youtubeEmbed.replace('<iframe', '<iframe allow="autoplay"');
            }

            // ‡ß®. ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶∏‡ßá‡¶ï‡¶∂‡¶® (‡ßß‡ß¶‡ß¶% ‡¶Ö‡¶∞‡¶ø‡¶ú‡¶ø‡¶®‡¶æ‡¶≤ ‡¶≤‡¶ú‡¶ø‡¶ï ‡¶ì ‡¶°‡¶ø‡¶ú‡¶æ‡¶á‡¶®)
            const grads = ["linear-gradient(180deg, #D32F2F 0%, #B71C1C 100%)", "linear-gradient(180deg, #1976D2 0%, #0D47A1 100%)", "linear-gradient(180deg, #388E3C 0%, #1B5E20 100%)"];
            document.getElementById('dynamic-download-section').innerHTML = `
                <div class="download-title-text">‚ÜïÔ∏èüî∞ Download Full Movie in HD üî∞‚ÜïÔ∏è</div>
                <div class="download-buttons-container">
                    <div onclick="handleDownloadClick('b1','${postId}','${post.adLink1}','${post.adLink2}')" class="download-btn-v2" style="background:${grads[0]}"><i class="fa-solid fa-circle-down"></i> <span class="btn-text-main">1080P FULL HD</span></div>
                    <div onclick="handleDownloadClick('b2','${postId}','${post.adLink1}','${post.adLink2}')" class="download-btn-v2" style="background:${grads[1]}"><i class="fa-solid fa-download"></i> <span class="btn-text-main">720P HD READY</span></div>
                    <div onclick="handleDownloadClick('b3','${postId}','${post.adLink1}','${post.adLink2}')" class="download-btn-v2" style="background:${grads[2]}"><i class="fa-solid fa-file-arrow-down"></i> <span class="btn-text-main">360P MOBILE</span></div>
                </div>
            `;
            
            // ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ö‡¶∞‡¶ø‡¶ú‡¶ø‡¶®‡¶æ‡¶≤ ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶≤‡¶ú‡¶ø‡¶ï ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
            window.handleDownloadClick = (btnId, pId, ad1, ad2) => {
                const key = `map_${pId}`;
                let map = JSON.parse(localStorage.getItem(key)) || {};
                if (map[btnId]) {
                    location.href = (map[btnId] === 'ad1') ? ad1 : ad2;
                    return;
                }
                let assignedCount = Object.keys(map).length;
                if (assignedCount < 2) {
                    const taskType = (assignedCount === 0) ? 'ad1' : 'ad2';
                    const adLink = (assignedCount === 0) ? ad1 : ad2;
                    sessionStorage.setItem('pendingDownloadTask', JSON.stringify({ id: btnId, type: taskType, key: key, blurTime: Date.now() }));
                    location.href = adLink;
                } else {
                    localStorage.removeItem(key);
                    location.href = `download.html?id=${pId}&from=watch`; // ‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ ‡¶∂‡¶®‡¶æ‡¶ï‡ßç‡¶§ ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡ßç‡¶Ø‡¶æ‡¶∞‡¶æ‡¶Æ‡¶ø‡¶ü‡¶æ‡¶∞
                }
            };
            
            // ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶á‡¶®‡¶ú‡ßá‡¶ï‡¶∂‡¶® ‡¶ì ‡¶∞‡¶ø‡¶´‡ßç‡¶∞‡ßá‡¶∂ ‡¶≤‡¶ú‡¶ø‡¶ï
            setupAds();
        }
    }

    function setupAds() {
        const inject = () => {
            // ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶∏‡ßç‡¶ü‡ßá‡¶∞‡¶æ ‡¶¨‡¶æ ‡¶Ö‡¶®‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶Ø ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡ßá‡¶∞ ‡¶á‡¶®‡¶≠‡ßã‡¶ï ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡ßç‡¶ü ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶Ø‡¶æ‡¶¨‡ßá
            console.log("Ads Refreshed at: " + new Date().toLocaleTimeString());
        };
        inject();
        setInterval(inject, 90000); // ‡ßØ‡ß¶ ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶° ‡¶™‡¶∞‡¶™‡¶∞ ‡¶∞‡¶ø‡¶´‡ßç‡¶∞‡ßá‡¶∂
    }

    loadWatchPage();
</script>
</body>
</html>
